!function(t){var e={};function o(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2)}([function(t,e){const o=2,s=50,i=50;t.exports=class{constructor(t,e,o,i){this.ctx=t,this.game=e,this.piece=o,this.x=i.x,this.y=i.y,this.width=s,this.color=i.color}draw(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,s,i),this.ctx.strokeRect(this.x,this.y,s,i)}display(t){t.fillStyle=this.color,t.fillRect(this.x-125,this.y+200,s,i),t.strokeRect(this.x-125,this.y+200,s,i)}fall(){this.y+=o}animate(){this.draw(),this.fall()}canFall(){let t=!0;return this.y>600&&(t=!1),this.game.allBlocks.forEach(e=>{e.x===this.x&&e.y===this.y+i&&(t=!1)}),t}canMoveLeft(){let t=!0;return this.x<s&&(t=!1),this.game.allBlocks.forEach(e=>{e.x===this.x-s&&e.y<this.y+i&&(t=!1)}),t}canMoveRight(){let t=!0;return this.x>=9*s&&(t=!1),this.game.allBlocks.forEach(e=>{e.x===this.x+s&&e.y<this.y+i&&(t=!1)}),t}drop(){this.y+=i}canRotate(t){let e=!0;const o=this.rotatePos(t,!0);return(o[0]<0||o[0]>10*s||o[1]>600)&&(e=!1),this.game.allBlocks.forEach(t=>{t.x===o[0]&&t.y<o.y+i&&(e=!1)}),e}rotatePos(t,e){let o;o="count"===t?[[0,-1],[1,0]]:[[0,1],[-1,0]];const s=[this.piece.blocks[0].x,this.piece.blocks[0].y],i=[this.x-s[0],this.y-s[1]],c=[o[0][0]*i[0]+o[0][1]*i[1],o[1][0]*i[0]+o[1][1]*i[1]];if(!0===e){return[s[0]+c[0],s[1]+c[1]]}this.x=s[0]+c[0],this.y=s[1]+c[1]}}},function(t,e,o){const s=o(0),i=[[{y:-100,x:200,color:"#7F7CAF"},{y:-100,x:250,color:"#7F7CAF"},{y:-50,x:200,color:"#7F7CAF"},{y:-50,x:250,color:"#7F7CAF"}],[{y:-50,x:200,color:"#28587B"},{y:-150,x:200,color:"#28587B"},{y:-100,x:200,color:"#28587B"},{y:-50,x:250,color:"#28587B"}],[{y:-50,x:250,color:"#9FB798"},{y:-150,x:250,color:"#9FB798"},{y:-100,x:250,color:"#9FB798"},{y:-50,x:200,color:"#9FB798"}],[{y:-50,x:250,color:"#8D3B72"},{y:-100,x:250,color:"#8D3B72"},{y:-50,x:200,color:"#8D3B72"},{y:-50,x:300,color:"#8D3B72"}],[{y:-150,x:200,color:"#4B3F72"},{y:-200,x:200,color:"#4B3F72"},{y:-100,x:200,color:"#4B3F72"},{y:-50,x:200,color:"#4B3F72"}],[{y:-50,x:250,color:"#B9929F"},{y:-100,x:200,color:"#B9929F"},{y:-100,x:250,color:"#B9929F"},{y:-50,x:300,color:"#B9929F"}],[{y:-50,x:250,color:"#4381C1"},{y:-100,x:250,color:"#4381C1"},{y:-100,x:300,color:"#4381C1"},{y:-50,x:200,color:"#4381C1"}]];t.exports=class{constructor(t,e){this.ctx=t,this.game=e,this.blocks=[],this.landed=!1,this.randPiece()}randPiece(){let t=Math.floor(Math.random()*i.length);i[t].forEach(t=>{this.blocks.push(new s(this.ctx,this.game,this,t))})}animate(){this.blocks.every(t=>t.canFall())?this.blocks.forEach(t=>t.animate()):this.landed=!0}move(){key("a",()=>{this.blocks.every(t=>t.canMoveLeft()&&!this.landed)&&this.blocks.forEach(t=>t.x-=t.width)}),key("d",()=>{this.blocks.every(t=>t.canMoveRight()&&!this.landed)&&this.blocks.forEach(t=>t.x+=t.width)}),key("q",()=>{this.blocks.every(t=>t.canRotate("counter")&&!this.landed)&&this.blocks.forEach(t=>{t.rotatePos("counter")})}),key("e",()=>{this.blocks.every(t=>t.canRotate("clock")&&!this.landed)&&this.blocks.forEach(t=>{t.rotatePos("clock")})})}display(t){this.blocks.forEach(e=>e.display(t))}}},function(t,e,o){const s=o(3);o(1);document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("my-canvas");t.width=500,t.height=650;const e=t.getContext("2d"),o=document.getElementById("side-canvas");o.width=300,o.height=300;const i=o.getContext("2d");new s(e,i).play()}))},function(t,e,o){o(0);const s=o(1),i="#9FB4C7",c=500,l=650;t.exports=class{constructor(t,e){this.game=this,this.ctx=t,this.sideCtx=e,this.score=0,this.height=l,this.piece=new s(this.ctx,this.game),this.nextPiece=new s(this.ctx,this.game),this.allBlocks=[]}draw(){this.ctx.clearRect(0,0,c,l),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,c,l),this.allBlocks.forEach(t=>t.draw())}display(){this.sideCtx.fillStyle=i,this.sideCtx.fillRect(0,0,300,300),this.nextPiece.display(this.sideCtx)}animate(){this.draw(),this.updateScore(),this.piece.animate(),this.piece.landed?(this.piece.blocks.forEach(t=>{this.allBlocks.push(t)}),this.completeLines(),this.gameOver()?alert(this.score):(this.piece=this.nextPiece,this.nextPiece=new s(this.ctx,this.game),this.play())):requestAnimationFrame(this.animate.bind(this))}play(){this.display(),this.piece.move(),this.animate()}completeLines(){const t={};let e=0;switch(this.allBlocks.forEach(e=>{t[e.y]?t[e.y]+=1:t[e.y]=1}),Object.keys(t).forEach(o=>{10===t[o]&&(this.allBlocks=this.allBlocks.filter(t=>t.y.toString()!==o),e+=1,this.allBlocks.forEach(t=>{t.y<parseInt(o)&&t.drop()}))}),e){case 1:this.score+=40;break;case 2:this.score+=100;break;case 3:this.score+=300;break;case 4:this.score+=1200}}gameOver(){return this.allBlocks.some(t=>t.y<0)}updateScore(){document.getElementById("score").innerHTML=this.score}}}]);